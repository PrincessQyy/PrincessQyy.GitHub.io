---
layout:     post
title:      "【Linux】grep使用总结"
date:       2017-05-16 15:17:00
author:     "Yuki"
---


grep：根据模式搜索文本，并将符合模式的文本行显示出来，它使用正则表达式作为模式匹配的条件。grep支持三种正则表达式引擎，分别用三个参数指定：

-E POSIX扩展正则表达式，ERE

-G POSIX基本表达式，BRE

-P Perl正则表达式，PCRE

不过在没学过perl语言的大多数情况下将只会使用到ERE和BRE,所以我也就总结这两类的基本用法啦~

## 基本语法和参数

grep使用的基本语法：

`grep [options] pattern [file]`

选项和参数：

-i 忽略大小写

--color 将符合条件的字符串高亮显示

-v 显示没有匹配到的行

-o 只显示被模式匹配到的字符串

-b 将二进制文件作为文本来进行匹配

-n 显示匹配文本所在行的行号

-A n 显示匹配行和其后面的n行

-B n 显示匹配行和其前面的n行

-C n 显示匹配行和其前后各n行
 
pattern：文本字符和正则表达式的元字符组合而成的匹配条件


## POSIX基本表达式，BRE


**元字符：**

. ：匹配任意单个字符

[] ：匹配指定范围内的任意单个字符

[^] :匹配指定范围外的任意单个字符

[:digit:],[:lower:],[:upper:],[:punct:],[:space:],[:alpha:],[:alnum:]，[:blank:]，[:graph:] 分别匹配数字、小写字母、大写字母、标点符号、空格、字母、字母和数字，空白键与tab键两者，除空白键与tab键两者之外的所有按键

**匹配次数**

\* ：匹配其前面的字符任意次

\？ ：匹配其前面的字符至多1次

.* ：匹配任意长度的任意字符

\\{m,n\\ } ：匹配其前面的字符至少m次，至多n次,无上限，n可以省略，m必须得写，\代表转义

**位置锚定**

^ ：锚定行首，此字符后面的任意内容必须出现在行首

$ ：锚定行尾，此字符后面的任意内容必须出现在行尾

^$ ：匹配空白行

\< ：锚定词首，其后面的任意字符必须作为单词的首部出现,\代表转义

\\> ：锚定词尾，其前面的任意字符必须作为单词的尾部出现,\代表转义

**分组**

\(\) 


\1,\2,\3... ： 后向引用第1个括号、第2个括号...内的字符串

**小tip**

1. 在使用grep时，可以使用别名 `alias grep='grep --color'`来使grep匹配出的字符串都有高亮显示，而不用每次都输入grep --color。
2. 在一组集合字符中，如果该字符组是连续的，例如要匹配[a-zA-Z]可以使用[[:alpha:]]。

## POSIX扩展表达式，ERE

POSIX扩展表达式可以使用 `grep -E` 或 `egrep` 命令。

这里我就只 列出和BRE不同的点吧

**次数匹配**

\+ ：匹配其前面的字符至少1次

{m,n} ：不需要用\转义

**真正实现了分组**

() :不用加\转义

**逻辑**

| ：表示or，指的是整个左边和整个右边的逻辑或 

**例子：**

找出1-255之间的整数：

`egrep '\<([1-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\>'`

找出所有ip地址（包括子网掩码）：

`egrep (\<([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\>\.){3}\<([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\>`


找出ABC三类的IP地址：

A: 0.0.0.0-127.255.255，其中段0和127不可用

B: 128.0.0.0-191.255.255.255

C: 192.0.0.0-223.255.255.255

`egrep '\<[1-9]|[1-9][0-9]|1[0-9]{2}|2[01][0-9]|22[0-3]\>(\.\<([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-4])\>){2}\.\<([1-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-4])\>'`








