---
layout:     post
title:      "【Linux】管道和重定向"
date:       2017-03-14 16:28:00
author:     "Yuki"
---

## 命令执行顺序的控制

#### 顺序执行多条命令

通常情况下，我们每次只能在终端输入一条命令，按下回车执行，执行完成后，我们再输入第二条命令，然后再按回车执行……这时你可能就会想要是我可以一次性输入完，其实简单的顺序执行可以使用分号**;**来完成。

#### 有选择的执行命令

关于上面的操作，不知你有没有思考过一个问题，如果我们在让它自动顺序执行命令时，前面的命令执行不成功，而后面的命令又依赖与上一条命令的结果，那么就会造成花了时间，最终却得到一个错误的结果，而且有时候直观的看你还无法判断结果是否正确。那么我们需要能够有选择性的来执行命令，比如上一条命令执行成功才继续下一条，或者不成功又该做出其它什么处理。

逻辑**&&**和**||**就是用来实现选择性执行的，它表示如果前面的命令执行结果（不是表示终端输出的内容，而是表示命令执行状态的结果）返回0则执行后面的，否则不执行，你可以用`echo $?`从环境变量获取上一次命令的返回结果。

## 管道

#### 管道基本知识

管道是什么,管道是一种通信机制，通常用于进程间的通信（也可通过socket进行网络通信），它表现出来的形式就是将前面每一个进程的输出(stdout)直接作为下一个进程的输入(stdin)。

管道又分为匿名管道和具名管道。我们在使用一些过滤程序时经常会用到的就是匿名管道，在命令行中由|分隔符表示，具名管道简单的说就是有名字的管道，通常只会在源程序中用到具名管道。

#### 数据流、管道使用

在Linux中，绝大多数的命令都是以纯文本格式输入的，而且大多数命令的输出也是纯文本格式，这就为命令的组合提供了条件，让多命令的协作成为可能。我们也知道，大多数的命令都很简单，极少出现复杂的功能，所以Linux为我们提供了管道和重定向机制支持多命令协作。

首先，我们来看看shell的数据流的定义：

<img src="../../../../../img/blogs/pipes and redirection/flow.png">

命令通过 STDIN 接收参数或数据，通过 STDOUT输出结果或通过STDERR输出错误。通过管道和重定向我们可以控制CLI的数据流。

<img src="../../../../../img/blogs/pipes and redirection/pipe.png">

* 管道通常用来组合不同的命令，以实现一个复杂的功能。
* 重定向通常用来保存某命令的输出信息或错误信息，可以用来记录执行结果或保存错误信息到一个指定的文件。



